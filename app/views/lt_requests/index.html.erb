<h1>リクエスト一覧</h1>
<button data-toggle="modal" href="#myModal" class="btn btn-primary btn-sm"><%= glyph(:plus) %>&nbsp;新規作成</button>

<hr>
<%= render 'form' %>

<% @requests.each_with_index do |request, index|  %>
  <% if index % 3 == 0 %>
    <div class="row">
  <% end %>
  <div class="col-md-4 lt_request_box">
    <h2><%= request.title %></h2>
    <p class="lt_request_content"><%= request.content %></p>
    <p><%= request.status_name %>&nbsp;<span class="glyphicon glyphicon-arrow-left green-allow"></span>&nbsp;<%= request.contributor.name %></p>
    <p>投稿日時:<%= request.created_at %> </p>

    <div class="btn-group">
      <button type="button" id="request_comment<%= request.id%>" href="#" class="btn btn-danger btn-xs dropdown-toggle" data-toggle="dropdown" data-target="comment<%= request.id %>" >コメント一覧</button>
      <div id="request_comments"></div>
      <div id="comment<%= request.id %>" class="dropdown-menu">
        <% request.request_comments.each do |request_comment| %>
          <a><%= request_comment.member.account %></a>
          <span><%= request_comment.created_at.strftime("%F"); %></span>
          <div><%= request_comment.content %></div>
          <div class="divider"></div>
        <% end %>
      </div>
      <button data-toggle="modal" href="#requestCommentModal<%= request.id %>" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-plus"></span>&nbsp;コメントする</button>
      <%= render partial: 'comment/form', locals: { comment: request.request_comments.build } %>
    </div>
  </div>
  <% if index % 3 == 2 %>
  </div> <!-- row -->
<% end %>

<% end %>
