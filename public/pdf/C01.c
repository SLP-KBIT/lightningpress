//====================================================================
//  2014年度 工学部 「プログラミング２」(富永)
//  C言語 第３部
//--------------------------------------------------------------------
//  関数の様々な応用
//  再帰法の計算過程 コラッツ数列の計算回数
//--------------------------------------------------------------------
//  第04週 教室型 第01セット
//  W04_C01/Q21_T0.c
//--------------------------------------------------------------------
//  tominaga  富永浩之
//  2014.05.07
//====================================================================


//====================================================================
//  番号 : 13T210
//  氏名 : 太田翔也
//====================================================================


//====================================================================
//  概略仕様
//====================================================================


//====================================================================
//  事前処理
//====================================================================

//--------------------------------------------------------------------
//  ヘッダファイル
//--------------------------------------------------------------------

#include <stdio.h>

//--------------------------------------------------------------------
//  定義マクロ
//--------------------------------------------------------------------

#define  ERR  -1 // エラーコード
#define  UPP  0xffffffff// 符号無整数の最大値
#define  CT   10    // 計算回数の上限

#define  EVEN(X) (( (X) % 2 == 0 ) ? 1 : 0)  // 偶数判定
#define  REM3(X) ((X) % 3)   // 3で割った余り


//====================================================================
//  大域宣言
//====================================================================

//--------------------------------------------------------------------
//  大域定義
//--------------------------------------------------------------------


//--------------------------------------------------------------------
//  関数原型
//--------------------------------------------------------------------

int collatz2(unsigned int a, int c);
int collatz3(unsigned int a, int c);


//====================================================================
//  本体処理
//====================================================================

int main(void)
{
    //----  局所宣言
    unsigned int a;
    int c;

    //----  入力処理
    scanf("%u", &a);

    //----  1行目の計算と出力
    c = collatz2(a, 1);
    printf(": %d\n", c);


    //----  2行目の計算と出力
    c = collatz3(a, 1);
    printf(": %d\n", c);


    //----  終了処理
    return 0;
}


//====================================================================
//  関数定義
//====================================================================

//--------------------------------------------------------------------
//  コラッツ数列
//--------------------------------------------------------------------

int collatz2(unsigned int a, int c)
{
    printf("%u ", a);                                // 引数の出力
    if ( a == 1 ) { return c; }                      // 初期条件で、回数を返却
    if ( EVEN(a) ) { return collatz2(a/2, c+1); }    // aが偶数のとき、漸化式を適用
    if ( a > UPP /3 ) { return ERR; }                // aが次の計算で範囲外
    return collatz2(3*a+1, c+1);                     // aが奇数のとき、  漸化式を適用
}

//--------------------------------------------------------------------
//  コラッツ数列の変種
//--------------------------------------------------------------------

int collatz3(unsigned int a, int c)
{
    // 引数の出力
    printf("%u ", a);
    // 初期条件
    if ( a == 1 ) { return c; }
    // 回数打切
    if ( c > CT ) { return ERR; }
    // 3で割り切れるとき
    if ( REM3(a) == 0 ) { return collatz3(a/3, ++c); }
    // 3で割って1余るとき
    if ( REM3(a) == 1 ) { 
        //   乗算が範囲外
        if ( a > (UPP/2)  ) { return ERR; }
        return collatz3((2*a+1), ++c); 
    }
    //   漸化式の適用
    // 3で割って1足りないとき
    if ( REM3(a) == 2 ) { 
         //   乗算が範囲外
        if ( a > (UPP/4) ) { return ERR;}
        return collatz3((4*a-1),++c); 
    }
    //   漸化式の適用
}